"0","bmi_infl <- influence(bmi_glm)"
"0","glimpse(bmi_infl)"
"1","List"
"1",""
"1"," of "
"1",""
"1","5"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","hat         "
"1",""
"1",":"
"1"," Named num [1:315] "
"1",""
"1","0.00713 0.0154 0.00383 0.00961 0.0034"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:315] "
"1",""
"1","""1"" ""2"" ""3"" ""4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","coefficients"
"1",""
"1",":"
"1"," num [1:315, 1:2] "
"1",""
"1","-0.02498 -0.032 -0.00869 -0.02977 0.00559"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""dimnames"")="
"1","List"
"1",""
"1"," of "
"1",""
"1","2"
"1",""
"1","
"
"1","  .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:315] "
"1",""
"1","""1"" ""2"" ""3"" ""4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .. .."
"1",""
"1","$ "
"1",""
"1",""
"1",""
"1",":"
"1"," chr [1:2] "
"1",""
"1","""(Intercept)"" ""bmi"""
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","sigma       "
"1",""
"1",":"
"1"," Named num [1:315] "
"1",""
"1","1.05 1.05 1.05 1.05 1.05"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:315] "
"1",""
"1","""1"" ""2"" ""3"" ""4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","dev.res     "
"1",""
"1",":"
"1"," Named num [1:315] "
"1",""
"1","0.601 0.405 0.716 0.543 0.786"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:315] "
"1",""
"1","""1"" ""2"" ""3"" ""4"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","pear.res    "
"1",""
"1",":"
"1"," Named num [1:315] "
"1",""
"1","0.445 0.292 0.541 0.399 0.601"
"1",""
"1"," ..."
"1",""
"1","
"
"1","  .."
"1",""
"1","- attr(*, ""names"")="
"1"," chr [1:315] "
"1",""
"1","""1"" ""2"" ""3"" ""4"""
"1",""
"1"," ..."
"1",""
"1","
"
"0","bmi_lm <- lm(lowplasma_01 ~ bmi, df)"
"0",""
"0","bmi_pred <- cbind(bmi_pred,"
"0","                   #xbeta = predict(bmi_glm),"
"0","                   v_logistic = bmi_infl$hat,"
"0","                  v_linear = hatvalues(bmi_lm))"
"0","glimpse(bmi_pred)"
"1","Rows: 315"
"1",""
"1","
"
"1","Columns: 25"
"1",""
"1","
"
"1","$ age          [3m[38;5;246m<dbl>[39m[23m 40, 36, 22, 56, 73, 60, 6â€¦
$ sex          [3m[38;5;246m<dbl>[39m[23m 2, 2, 2, 2, 1, 2, 2, 2, 2â€¦
$ smokstat     [3m[38;5;246m<dbl>[39m[23m 1, 1, 2, 2, 2, 2, 1, 3, 2â€¦
$ bmi          [3m[38;5;246m<dbl>[39m[23m 31.2, 40.3, 27.0, 33.6, 2â€¦
$ vituse       [3m[38;5;246m<fct>[39m[23m often, notoften, often, oâ€¦
$ calories     [3m[38;5;246m<dbl>[39m[23m 12.6, 5.9, 11.4, 6.3, 11.â€¦
$ fat          [3m[38;5;246m<dbl>[39m[23m 165.7, 51.2, 123.8, 59.1,â€¦
$ fiber        [3m[38;5;246m<dbl>[39m[23m 14.4, 13.7, 5.1, 6.8, 14.â€¦
$ alcohol      [3m[38;5;246m<dbl>[39m[23m 0.0, 0.0, 0.3, 0.0, 18.2,â€¦
$ cholesterol  [3m[38;5;246m<dbl>[39m[23m 900.7, 135.8, 440.3, 111.â€¦
$ betadiet     [3m[38;5;246m<dbl>[39m[23m 1.0, 1.7, 1.7, 0.6, 3.5, â€¦
$ betaplasma   [3m[38;5;246m<dbl>[39m[23m 10, 14, 16, 19, 21, 22, 2â€¦
$ lowplasma_01 [3m[38;5;246m<dbl>[39m[23m 1, 1, 1, 1, 1, 1, 1, 1, 1â€¦
$ lowplasma_hl [3m[38;5;246m<fct>[39m[23m low, low, low, low, low, â€¦
$ phat         [3m[38;5;246m<dbl>[39m[23m 0.8345199, 0.9212466, 0.7â€¦
$ logit.fit    [3m[38;5;246m<dbl>[39m[23m 1.6180056, 2.4594058, 1.2â€¦
$ logit.se.fit [3m[38;5;246m<dbl>[39m[23m 0.2272916, 0.4606835, 0.1â€¦
$ logit.lwr    [3m[38;5;246m<dbl>[39m[23m 1.1725222, 1.5564828, 0.9â€¦
$ logit.upr    [3m[38;5;246m<dbl>[39m[23m 2.0634891, 3.3623289, 1.5â€¦
$ odds.lwr     [3m[38;5;246m<dbl>[39m[23m 3.230130, 4.742113, 2.559â€¦
$ odds.upr     [3m[38;5;246m<dbl>[39m[23m 7.873393, 28.856316, 4.57â€¦
$ p.lwr        [3m[38;5;246m<dbl>[39m[23m 0.7636006, 0.8258481, 0.7â€¦
$ p.upr        [3m[38;5;246m<dbl>[39m[23m 0.8873035, 0.9665062, 0.8â€¦
$ v_logistic   [3m[38;5;246m<dbl>[39m[23m 0.007134489, 0.015398724,â€¦
$ v_linear     [3m[38;5;246m<dbl>[39m[23m 0.005416058, 0.020790276,â€¦"
"1",""
"1","
"
"0","pplus1_bmi <- length(bmi_glm$coefficients)"
"0","n <- nobs(bmi_glm)"
"0",""
"0","ggplot(bmi_pred, aes(x = bmi)) +"
"0","  geom_point(aes(y=v_logistic, color = ""logistic"")) +"
"0","  geom_point(aes(y=v_linear, color = ""linear"")) +"
"0","  geom_hline(yintercept = c(2*pplus1_bmi/n), linetype = ""dashed"") +"
"0","  scale_color_manual(values = c(""logistic"" = ""red"", ""linear"" = ""blue"")) +"
"0","  labs("
"0","    title = ""Leverage of BMI"","
"0","    x = ""BMI (kg/mÂ²)"", "
"0","    y = ""Leverage"","
"0","    color = ""Model"""
"0","  ) +"
"0","  theme("
"0","    plot.title = element_text(size = 10),        # Title size"
"0","    axis.title.x = element_text(size = 9),       # X-axis label size"
"0","    axis.title.y = element_text(size = 9),       # Y-axis label size"
"0","    axis.text.x = element_text(size = 8),        # X-axis tick values"
"0","    axis.text.y = element_text(size = 8),         # Y-axis tick values,        # Y-axis tick values"
"0","    plot.caption = element_text(size = 8),        # Caption size"
"0","    legend.title = element_text(size = 9),"
"0","    legend.text = element_text(size = 8)"
"0","  )"
