"0",""
"0","df |> mutate(phat = predict(bmi_glm, type = ""response"")) -> bmi_pred"
"0","bmi_pred <- cbind("
"0","  bmi_pred,"
"0","  logit = predict(bmi_glm, se.fit = TRUE))"
"0","glimpse(bmi_pred)"
"1","Rows: 315"
"1",""
"1","
"
"1","Columns: 18"
"1",""
"1","
"
"1","$ age                  [3m[38;5;246m<dbl>[39m[23m 40, 36, 22, 56, 7â€¦
$ sex                  [3m[38;5;246m<dbl>[39m[23m 2, 2, 2, 2, 1, 2,â€¦
$ smokstat             [3m[38;5;246m<dbl>[39m[23m 1, 1, 2, 2, 2, 2,â€¦
$ bmi                  [3m[38;5;246m<dbl>[39m[23m 31.2, 40.3, 27.0,â€¦
$ vituse               [3m[38;5;246m<fct>[39m[23m often, notoften, â€¦
$ calories             [3m[38;5;246m<dbl>[39m[23m 12.6, 5.9, 11.4, â€¦
$ fat                  [3m[38;5;246m<dbl>[39m[23m 165.7, 51.2, 123.â€¦
$ fiber                [3m[38;5;246m<dbl>[39m[23m 14.4, 13.7, 5.1, â€¦
$ alcohol              [3m[38;5;246m<dbl>[39m[23m 0.0, 0.0, 0.3, 0.â€¦
$ cholesterol          [3m[38;5;246m<dbl>[39m[23m 900.7, 135.8, 440â€¦
$ betadiet             [3m[38;5;246m<dbl>[39m[23m 1.0, 1.7, 1.7, 0.â€¦
$ betaplasma           [3m[38;5;246m<dbl>[39m[23m 10, 14, 16, 19, 2â€¦
$ lowplasma_01         [3m[38;5;246m<dbl>[39m[23m 1, 1, 1, 1, 1, 1,â€¦
$ lowplasma_hl         [3m[38;5;246m<fct>[39m[23m low, low, low, loâ€¦
$ phat                 [3m[38;5;246m<dbl>[39m[23m 0.8345199, 0.9212â€¦
$ logit.fit            [3m[38;5;246m<dbl>[39m[23m 1.6180056, 2.4594â€¦
$ logit.se.fit         [3m[38;5;246m<dbl>[39m[23m 0.2272916, 0.4606â€¦
$ logit.residual.scale [3m[38;5;246m<dbl>[39m[23m 1, 1, 1, 1, 1, 1,â€¦"
"1",""
"1","
"
"0","bmi_pred |> mutate(logit.residual.scale = NULL) -> bmi_pred"
"0",""
"0","lambda <- qnorm(1 - 0.05/2)"
"0","bmi_pred |> mutate("
"0","  logit.lwr = logit.fit - lambda*logit.se.fit,"
"0","  logit.upr = logit.fit + lambda*logit.se.fit,"
"0","  "
"0","  odds.lwr = exp(logit.lwr),"
"0","  odds.upr = exp(logit.upr),"
"0","  "
"0","  p.lwr = odds.lwr/(1 + odds.lwr),"
"0","  p.upr = odds.upr/(1 + odds.upr)) -> bmi_pred"
"0","glimpse(bmi_pred)"
"1","Rows: 315"
"1",""
"1","
"
"1","Columns: 23"
"1",""
"1","
"
"1","$ age          [3m[38;5;246m<dbl>[39m[23m 40, 36, 22, 56, 73, 60, 6â€¦
$ sex          [3m[38;5;246m<dbl>[39m[23m 2, 2, 2, 2, 1, 2, 2, 2, 2â€¦
$ smokstat     [3m[38;5;246m<dbl>[39m[23m 1, 1, 2, 2, 2, 2, 1, 3, 2â€¦
$ bmi          [3m[38;5;246m<dbl>[39m[23m 31.2, 40.3, 27.0, 33.6, 2â€¦
$ vituse       [3m[38;5;246m<fct>[39m[23m often, notoften, often, oâ€¦
$ calories     [3m[38;5;246m<dbl>[39m[23m 12.6, 5.9, 11.4, 6.3, 11.â€¦
$ fat          [3m[38;5;246m<dbl>[39m[23m 165.7, 51.2, 123.8, 59.1,â€¦
$ fiber        [3m[38;5;246m<dbl>[39m[23m 14.4, 13.7, 5.1, 6.8, 14.â€¦
$ alcohol      [3m[38;5;246m<dbl>[39m[23m 0.0, 0.0, 0.3, 0.0, 18.2,â€¦
$ cholesterol  [3m[38;5;246m<dbl>[39m[23m 900.7, 135.8, 440.3, 111.â€¦
$ betadiet     [3m[38;5;246m<dbl>[39m[23m 1.0, 1.7, 1.7, 0.6, 3.5, â€¦
$ betaplasma   [3m[38;5;246m<dbl>[39m[23m 10, 14, 16, 19, 21, 22, 2â€¦
$ lowplasma_01 [3m[38;5;246m<dbl>[39m[23m 1, 1, 1, 1, 1, 1, 1, 1, 1â€¦
$ lowplasma_hl [3m[38;5;246m<fct>[39m[23m low, low, low, low, low, â€¦
$ phat         [3m[38;5;246m<dbl>[39m[23m 0.8345199, 0.9212466, 0.7â€¦
$ logit.fit    [3m[38;5;246m<dbl>[39m[23m 1.6180056, 2.4594058, 1.2â€¦
$ logit.se.fit [3m[38;5;246m<dbl>[39m[23m 0.2272916, 0.4606835, 0.1â€¦
$ logit.lwr    [3m[38;5;246m<dbl>[39m[23m 1.1725222, 1.5564828, 0.9â€¦
$ logit.upr    [3m[38;5;246m<dbl>[39m[23m 2.0634891, 3.3623289, 1.5â€¦
$ odds.lwr     [3m[38;5;246m<dbl>[39m[23m 3.230130, 4.742113, 2.559â€¦
$ odds.upr     [3m[38;5;246m<dbl>[39m[23m 7.873393, 28.856316, 4.57â€¦
$ p.lwr        [3m[38;5;246m<dbl>[39m[23m 0.7636006, 0.8258481, 0.7â€¦
$ p.upr        [3m[38;5;246m<dbl>[39m[23m 0.8873035, 0.9665062, 0.8â€¦"
"1",""
"1","
"
"0","ggplot(bmi_pred, aes(bmi, lowplasma_01)) +"
"0","  geom_point() +"
"0","  geom_smooth(se = FALSE, linetype = ""dashed"") +"
"0","  geom_line(aes(y = phat), color = ""red"", size = 1) +"
"0","  geom_ribbon(aes(ymin = p.lwr, ymax = p.upr), alpha = 0.2) +"
"0","  xlab(""BMI (kg/mÂ²)"") +"
"0","  ylab(""Low betaplasma"") +"
"0","  labs(title = ""Low betaplasma (=1) or Not low betaplasma (=0) vs BMI"","
"0","       caption = ""red = fitted line, with 95% confidence interval, "
"0","       blue dashed = moving average"") +"
"0","  theme("
"0","    plot.title = element_text(size = 10),        # Title size"
"0","    axis.title.x = element_text(size = 9),       # X-axis label size"
"0","    axis.title.y = element_text(size = 9),       # Y-axis label size"
"0","    axis.text.x = element_text(size = 8),        # X-axis tick values"
"0","    axis.text.y = element_text(size = 8),         # Y-axis tick values,        # Y-axis tick values"
"0","    plot.caption = element_text(size = 8)        # Caption size"
"0","  )"
"2","Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
Please use `linewidth` instead."
